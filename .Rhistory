trial = rep(1:nTrialsS, nBlocksS*length(files)),
chosen = NA,
reward = NA,
rt = NA,
session = session)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial] <- temp$restless$time[[2]][[trial]]
}
}
bonus$Restless[bonus$ID == i] <- sum(restless$reward[restless$ID == i])
}
View(bonus)
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = 1:length(files),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
sam <- data.frame(ID = rep(1:length(files), each = nBlocksS*nTrialsS),
block = rep(rep(1:nBlocksS, each = nTrialsS), length(files)),
trial = rep(1:nTrialsS, nBlocksS*length(files)),
chosen = NA,
reward = NA,
rt = NA,
session = session)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial] <- temp$restless$time[[2]][[trial]]
}
}
bonus$Restless[bonus$ID == i] <- sum(restless$reward[restless$ID == i])
}
View(bonus)
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
Rrewards <- data.frame(block = rep(1:(nBlocksR+1), each = nTrialsR),
trial = rep(1:nTrialsR, nBlocksR+1),
rew1 = NA,
rew2 = NA,
rew3 = NA,
rew4 = NA)
for (block in 1:(nBlocksR+1)){# +1 bc there is the practice round too
for (trial in 1:nTrialsR){
if (block == 1 & trial > 10){next}
Rrewards$rew1[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,1]
Rrewards$rew2[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,2]
Rrewards$rew3[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,3]
Rrewards$rew4[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial, 4]
}
}
# calculate max reward
Rrewards$row <- 1:nrow(Rrewards)
Rrewards$max <- apply(as.array(Rrewards$row), 1, function(x) max(Rrewards[x,3:6]))
maxRestless <- sum(Rrewards$max, na.rm = T)
bonus$Restless <- bonus$Restless /maxRestless
bonus$TotalBonus <- bonus$Restless * 2
library(tidyverse)
library(ggplot2)
library(jsonlite)
theme_set(theme_classic(base_size = 14))
setwd("/Users/kwitte/Documents/GitHub/exploration-psychometrics")
# select required directory by setting data_idx index
data_idx <- 3
rel_dir_data_bandits <- c("data/pilot/bandits/", "data/2023-11-lab-pilot/bandits/", "data/pilot4arb/")[data_idx]
rel_dir_data_qs <- c("data/pilot/qs/", "data/2023-11-lab-pilot/qs/")[data_idx]
### load data ########
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = 1:length(files),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
sam <- data.frame(ID = rep(1:length(files), each = nBlocksS*nTrialsS),
block = rep(rep(1:nBlocksS, each = nTrialsS), length(files)),
trial = rep(1:nTrialsS, nBlocksS*length(files)),
chosen = NA,
reward = NA,
rt = NA,
session = session)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial] <- temp$restless$time[[2]][[trial]]
}
}
bonus$Restless[bonus$ID == i] <- sum(restless$reward[restless$ID == i])
}
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
Rrewards <- data.frame(block = rep(1:(nBlocksR+1), each = nTrialsR),
trial = rep(1:nTrialsR, nBlocksR+1),
rew1 = NA,
rew2 = NA,
rew3 = NA,
rew4 = NA)
for (block in 1:(nBlocksR+1)){# +1 bc there is the practice round too
for (trial in 1:nTrialsR){
if (block == 1 & trial > 10){next}
Rrewards$rew1[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,1]
Rrewards$rew2[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,2]
Rrewards$rew3[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,3]
Rrewards$rew4[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial, 4]
}
}
# calculate max reward
Rrewards$row <- 1:nrow(Rrewards)
Rrewards$max <- apply(as.array(Rrewards$row), 1, function(x) max(Rrewards[x,3:6]))
maxRestless <- sum(Rrewards$max, na.rm = T)
bonus$Restless <- bonus$Restless /maxRestless
library(tidyverse)
library(ggplot2)
library(jsonlite)
theme_set(theme_classic(base_size = 14))
setwd("/Users/kwitte/Documents/GitHub/exploration-psychometrics")
# select required directory by setting data_idx index
data_idx <- 3
rel_dir_data_bandits <- c("data/pilot/bandits/", "data/2023-11-lab-pilot/bandits/", "data/pilot4arb/")[data_idx]
rel_dir_data_qs <- c("data/pilot/qs/", "data/2023-11-lab-pilot/qs/")[data_idx]
### load data ########
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = rep(NA, length(files)),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
sam <- data.frame(ID = rep(1:length(files), each = nBlocksS*nTrialsS),
block = rep(rep(1:nBlocksS, each = nTrialsS), length(files)),
trial = rep(1:nTrialsS, nBlocksS*length(files)),
chosen = NA,
reward = NA,
rt = NA,
session = session)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial] <- temp$restless$time[[2]][[trial]]
}
}
bonus$ID[i] <- temp$subjectID
bonus$Restless[i] <- sum(restless$reward[restless$ID == i])
}
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
Rrewards <- data.frame(block = rep(1:(nBlocksR+1), each = nTrialsR),
trial = rep(1:nTrialsR, nBlocksR+1),
rew1 = NA,
rew2 = NA,
rew3 = NA,
rew4 = NA)
for (block in 1:(nBlocksR+1)){# +1 bc there is the practice round too
for (trial in 1:nTrialsR){
if (block == 1 & trial > 10){next}
Rrewards$rew1[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,1]
Rrewards$rew2[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,2]
Rrewards$rew3[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,3]
Rrewards$rew4[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial, 4]
}
}
# calculate max reward
Rrewards$row <- 1:nrow(Rrewards)
Rrewards$max <- apply(as.array(Rrewards$row), 1, function(x) max(Rrewards[x,3:6]))
maxRestless <- sum(Rrewards$max, na.rm = T)
bonus$Restless <- bonus$Restless /maxRestless
restless$reward1 <- NA
restless$reward2 <- NA
restless$reward3 <- NA
restless$reward4 <- NA
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
temp <- data.frame(rewardsR[[2]])
restless$reward1 <- rep(temp$X1, length(unique(restless$ID)))
restless$reward2 <- rep(temp$X2, length(unique(restless$ID)))
restless$reward3 <- rep(temp$X3, length(unique(restless$ID)))
restless$reward4 <- rep(temp$X4, length(unique(restless$ID)))
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = rep(NA, length(files)),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR*nBlocksR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial] <- temp$restless$time[[2]][[trial]]
}
}
bonus$ID[i] <- temp$subjectID
bonus$Restless[i] <- sum(restless$reward[restless$ID == i])
}
restless$reward1 <- NA
restless$reward2 <- NA
restless$reward3 <- NA
restless$reward4 <- NA
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
temp <- data.frame(rewardsR[[2]])
restless$reward1 <- rep(temp$X1, length(unique(restless$ID)))
restless$reward2 <- rep(temp$X2, length(unique(restless$ID)))
restless$reward3 <- rep(temp$X3, length(unique(restless$ID)))
restless$reward4 <- rep(temp$X4, length(unique(restless$ID)))
restless$reward1 <- NA
restless$reward2 <- NA
restless$reward3 <- NA
restless$reward4 <- NA
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
temp <- data.frame(rewardsR[[2]])
View(temp)
temp <- rbind(temp, data.frame(rewardsR[[3]]))
restless$reward1 <- rep(temp$X1, length(unique(restless$ID)))
restless$reward2 <- rep(temp$X2, length(unique(restless$ID)))
restless$reward3 <- rep(temp$X3, length(unique(restless$ID)))
restless$reward4 <- rep(temp$X4, length(unique(restless$ID)))
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = rep(NA, length(files)),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR*nBlocksR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial & restless$block == block] <- temp$restless$choice[[2]][[trial]]
restless$reward[restless$ID == i & restless$trial == trial& restless$block == block] <- temp$restless$reward[[2]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial& restless$block == block] <- temp$restless$time[[2]][[trial]]
}
}
bonus$ID[i] <- temp$subjectID
bonus$Restless[i] <- sum(restless$reward[restless$ID == i])
}
### restless
restless$reward1 <- NA
restless$reward2 <- NA
restless$reward3 <- NA
restless$reward4 <- NA
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
temp <- data.frame(rewardsR[[2]])
temp <- rbind(temp, data.frame(rewardsR[[3]]))
restless$reward1 <- rep(temp$X1, length(unique(restless$ID)))
restless$reward2 <- rep(temp$X2, length(unique(restless$ID)))
restless$reward3 <- rep(temp$X3, length(unique(restless$ID)))
restless$reward4 <- rep(temp$X4, length(unique(restless$ID)))
View(temp)
session = 1
nBlocksH = 80
nTrialsH = 10
nBlocksS = 30
nTrialsS = 10
nBlocksR = 2
nTrialsR = 200
files = list.files(path = rel_dir_data_bandits)
files <- files[!grepl("temp", files)]
lookup <- data.frame(PID = rep(NA, length(files)),
ID = 1:length(files))
bonus <- data.frame(ID = rep(NA, length(files)),
TotalBonus = NA,
Horizon = NA,
Sam = NA,
Restless = NA)
restless <- data.frame(ID = rep(1:length(files), each = nTrialsR*nBlocksR),
block = rep(rep(1:nBlocksR, each = nTrialsR), length(files)),
trial = 1:nTrialsR,
chosen = NA,
reward = NA,
rt = NA,
session = session)
for (i in 1:length(files)){
temp <- fromJSON(paste(rel_dir_data_bandits,files[i], sep = ""))
# add PID into lookup
lookup$PID[i] <- temp$subjectID
## restless
for (block in 1:nBlocksR){
for (trial in 1:nTrialsR){
restless$chosen[restless$ID == i & restless$trial == trial & restless$block == block] <- temp$restless$choice[[block+1]][[trial]] # +1 bc of practice
restless$reward[restless$ID == i & restless$trial == trial& restless$block == block] <- temp$restless$reward[[block+1]][[trial]]
restless$rt[restless$ID == i & restless$trial == trial& restless$block == block] <- temp$restless$time[[block+1]][[trial]]
}
}
bonus$ID[i] <- temp$subjectID
bonus$Restless[i] <- sum(restless$reward[restless$ID == i])
}
View(lookup)
#write.csv(lookup, file = "/Users/kwitte/Library/CloudStorage/OneDrive-Personal/CPI/ExplorationReview/BanditLookup.csv")
write.csv(lookup, file = str_c(str_remove(rel_dir_data_bandits, "[a-z]*/$"),  "BanditLookup.csv"))
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
Rrewards <- data.frame(block = rep(1:(nBlocksR+1), each = nTrialsR),
trial = rep(1:nTrialsR, nBlocksR+1),
rew1 = NA,
rew2 = NA,
rew3 = NA,
rew4 = NA)
for (block in 1:(nBlocksR+1)){# +1 bc there is the practice round too
for (trial in 1:nTrialsR){
if (block == 1 & trial > 10){next}
Rrewards$rew1[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,1]
Rrewards$rew2[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,2]
Rrewards$rew3[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial,3]
Rrewards$rew4[Rrewards$block == block & Rrewards$trial == trial]<-  rewardsR[[block]][trial, 4]
}
}
# calculate max reward
Rrewards$row <- 1:nrow(Rrewards)
Rrewards$max <- apply(as.array(Rrewards$row), 1, function(x) max(Rrewards[x,3:6]))
maxRestless <- sum(Rrewards$max, na.rm = T)
bonus$Restless <- bonus$Restless /maxRestless
View(bonus)
save(maxRestless, file = "pilot4arb/maxRewards.Rda")
################# get ground truth variables ###############
### restless
restless$reward1 <- NA
restless$reward2 <- NA
restless$reward3 <- NA
restless$reward4 <- NA
rewardsR <- fromJSON(paste("pilot4arb/rewards4ARB", session, ".json", sep = ""))
temp <- data.frame(rewardsR[[2]])
temp <- rbind(temp, data.frame(rewardsR[[3]]))
restless$reward1 <- rep(temp$X1, length(unique(restless$ID)))
restless$reward2 <- rep(temp$X2, length(unique(restless$ID)))
restless$reward3 <- rep(temp$X3, length(unique(restless$ID)))
restless$reward4 <- rep(temp$X4, length(unique(restless$ID)))
save(restless, file = str_c(str_remove(rel_dir_data_bandits, "[a-z]*/$"),  "bandits.Rda"))
data <- restless
data$optimalR <- rep(apply(as.array(data$trial[data$ID == 1]), 1, function(x) max(c(data$reward1[data$trial == x],
data$reward2[data$trial == x],
data$reward3[data$trial == x],
data$reward4[data$trial == x]))),
length(unique(data$ID)))
data$regret <- data$optimalR - data$reward
data$trialBin <- round(data$trial/10)
regret <- ddply(data, ~ID+trialBin, summarise, regret = meann(regret))
library(ggplot2)
theme_set(theme_classic(base_size = 15))
library(lme4)
library(plyr)
library(brms)
library(tidyr)
library(ggridges)
se<-function(x){sd(x, na.rm = T)/sqrt(length(na.omit(x)))}
meann <- function(x){mean(x, na.rm = T)}
data <- restless
data$optimalR <- rep(apply(as.array(data$trial[data$ID == 1]), 1, function(x) max(c(data$reward1[data$trial == x],
data$reward2[data$trial == x],
data$reward3[data$trial == x],
data$reward4[data$trial == x]))),
length(unique(data$ID)))
data$regret <- data$optimalR - data$reward
data$trialBin <- round(data$trial/10)
regret <- ddply(data, ~ID+trialBin, summarise, regret = meann(regret))
# dist plot
ggplot(regret, aes(x = regret))+ geom_density_ridges(aes(y = as.factor(trialBin)), alpha = 0.6) +
xlim(c(0, max(regret$regret)))
data <- restless
data$optimalR <- rep(apply(as.array(data$trial[data$ID == 1]), 1, function(x) max(c(data$reward1[data$trial == x],
data$reward2[data$trial == x],
data$reward3[data$trial == x],
data$reward4[data$trial == x]))),
length(unique(data$ID)))
View(data)
data$optimalR <- rep(apply(as.array(paste(data$trial[data$ID == 1], data$block[data$ID == 1])), 1, function(x) max(c(data$reward1[data$trial == x],
data$reward2[data$trial == x],
data$reward3[data$trial == x],
data$reward4[data$trial == x]))),
length(unique(data$ID)))
data$optimalR <- rep(apply(as.array(paste(data$trial[data$ID == 1], data$block[data$ID == 1])), 1, function(x) max(c(data$reward1[paste(data$trial, data$block) == x],
data$reward2[paste(data$trial, data$block) == x],
data$reward3[paste(data$trial, data$block) == x],
data$reward4[paste(data$trial, data$block) == x]))),
length(unique(data$ID)))
data$trialBin <- round(data$trial/10)
regret <- ddply(data, ~ID+trialBin+block, summarise, regret = meann(regret))
warnings()
View(regret)
data$regret <- data$optimalR - data$reward
data$trialBin <- round(data$trial/10)
regret <- ddply(data, ~ID+trialBin+block, summarise, regret = meann(regret))
# dist plot
ggplot(regret, aes(x = regret))+ geom_density_ridges(aes(y = as.factor(trialBin)), alpha = 0.6) +
xlim(c(0, max(regret$regret)))
# dist plot
ggplot(regret, aes(x = regret))+ geom_density_ridges(aes(y = as.factor(trialBin)), alpha = 0.6) +
xlim(c(0, max(regret$regret))) + facet_wrap(vars(block))
data$chooseBest <- ifelse(data$reward == data$optimalR, 1, 0)
best <- ddply(data, ~ID+trialBin+block, summarise, optimal = meann(chooseBest))
head(best)
# dist plot
ggplot(best, aes(x = optimal))+ geom_density_ridges(aes(y = as.factor(trialBin)), alpha = 0.6) +
xlim(c(0, 1))+
geom_vline(aes(xintercept = 0.25))+ facet_wrap(vars(block))
View(restless)

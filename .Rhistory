load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor")
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
View(cors)
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(
"CEI" = "exploration",
"BIG_5" = "openness",
"STICSAcog" = "cog. anxiety",
"STICSAsoma" = "soma. anxiety",
"PHQ_9" = "depression",
"PANASneg" = "neg. mood",
"PANASpos" = "pos. mood",
"OS_recall_0" = "oper. span",
"SS_recall_0" = "sym. span",
"WMU_recall_0" = "updating"
))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "exploration",
"BIG_5" = "openness",
"STICSAcog" = "cog. anxiety",
"STICSAsoma" = "soma. anxiety",
"PHQ_9" = "depression",
"PANASneg" = "neg. mood",
"PANASpos" = "pos. mood",
"OS_recall_0" = "oper. span",
"SS_recall_0" = "sym. span",
"WMU_recall_0" = "updating"
))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cog. anxiety", "Soma. anxiety", "Depression",
"Neg. mood", "Pos. mood",
"Oper. span", "Sym. spam", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cog. anxiety", "Soma. anxiety", "Depression",
"Neg. mood", "Pos. mood",
"Oper. span", "Sym. span", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cog. anxiety", "Soma. anxiety", "Depression",
"Neg. mood", "Pos. mood",
"Oper. span", "Sym. span", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 25, hjust = 1))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "Correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
###################### final correlation matrix #########################
s <- session
params <- readRDS("analysis/bandits/allParams.rds") %>%
mutate(horizon = ifelse(is.na(horizon), "long", horizon),
task = recode(task,"sam" = "2AB"),
predictor = paste(task, predictor, sep = "_")) %>%
subset(horizon == "long" & !grepl("ntercept", predictor) & session == s,
select = c("ID", "predictor", "estimate"))
load(sprintf("analysis/bandits/optimal_switch_session%i.Rda", session))
load(sprintf("analysis/qdat_session%i.Rda", session))
###################### final correlation matrix #########################
s <- session
params <- readRDS("analysis/bandits/allParams.rds") %>%
mutate(task = recode(task,"sam" = "2AB"),
predictor = paste(task, predictor, sep = "_")) %>%
subset(!grepl("ntercept", predictor) & session == s,
select = c("ID", "predictor", "estimate"))
load(sprintf("analysis/bandits/optimal_switch_session%i.Rda", session))
load(sprintf("analysis/qdat_session%i.Rda", session))
Poptimal <- Poptimal %>%
rename(estimate = Poptimal) %>%
mutate(predictor = paste(model, "Poptimal", sep = "_")) %>%
subset(select = c("ID", "predictor", "estimate"))
switch <- switch %>%
rename(estimate = Pswitch) %>%
mutate(predictor = paste(model, "Pswitch", sep = "_")) %>%
subset(select = c(ID, predictor, estimate))
avg <- avg %>%
rename(estimate = score,
predictor = measure)
wm <- read.csv("data/wm-performance.csv") %>%
pivot_longer(cols = -c("participant_id"), names_to = "predictor", values_to = "estimate") %>%
mutate(session = parse_number(predictor)+1,
ID = as.numeric(as.character(participant_id))) %>%
subset(grepl("recall", predictor) & session == s)
all <- list(params, Poptimal, switch, wm, avg) %>%
bind_rows() %>%
pivot_wider(id_cols = "ID", names_from = "predictor", values_from = "estimate")
cors <- all %>%
subset(select = -ID) %>%
cor(use = "pairwise.complete.obs") %>%
as.data.frame()
selected_columns <- colnames(cors) %>%
str_subset("^(?!.*(2AB|restless|horizon)).*$")
# Select rows that contain "2AB", "restless", or "horizon"
selected_rows <- rownames(cors) %>%
str_subset("2AB|restless|horizon")
# Filter the correlation matrix
cors <- cors[selected_rows, selected_columns]
save(cors, file = "analysis/external_validity_cors.Rda")
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cog. anxiety",
"STICSAsoma" = "Soma. anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Neg. mood",
"PANASpos" = "Pos. mood",
"OS_recall_0" = "Oper. span",
"SS_recall_0" = "Sym. span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cog. anxiety", "Soma. anxiety", "Depression",
"Neg. mood", "Pos. mood",
"Oper. span", "Sym. span", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "Correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cognitive anxiety",
"STICSAsoma" = "Somatic anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Negative mood",
"PANASpos" = "Positive mood",
"OS_recall_0" = "Operation span",
"SS_recall_0" = "Symmetry span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-g. restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-g. horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-g. 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-g. restless", "Value-g. 2AB", "Value-g. horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cognitive anxiety", "Somatic anxiety", "Depression",
"Negative mood", "Positive mood",
"Operation span", "Symmetry span", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "Correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
load("analysis/external_validity_cors.Rda")
cors$x <- row.names(cors)
cors <- cors %>%
pivot_longer(cols = -x, names_to = "y", values_to = "cor") %>%
mutate(y = recode(y,
"CEI" = "Exploration",
"BIG_5" = "Openness",
"STICSAcog" = "Cognitive anxiety",
"STICSAsoma" = "Somatic anxiety",
"PHQ_9" = "Depression",
"PANASneg" = "Negative mood",
"PANASpos" = "Positive mood",
"OS_recall_0" = "Operation span",
"SS_recall_0" = "Symmetry span",
"WMU_recall_0" = "Updating"
),
x = recode(x,
"restless_V" = "Value-guided restless",
"restless_RU" = "Directed restless",
"restless_Pswitch" = "P(switch) restless",
"restless_Poptimal" = "P(optimal) restless",
"horizon_Pswitch" = "P(switch) horizon",
"horizon_Poptimal" = "P(optimal) horizon",
"horizon_info" = "Directed horizon",
"horizon_delta_mean" = "Value-guided horizon",
"2AB_VTU" = "Random 2AB",
"2AB_V" = "Value-guided 2AB",
"2AB_RU" = "Directed 2AB",
"2AB_Pswitch" = "P(switch) 2AB",
"2AB_Poptimal" = "P(optimal) 2AB",
))
cors$x <- factor(cors$x, levels = c("Random 2AB", "Directed restless","Directed 2AB","Directed horizon",
"Value-guided restless", "Value-guided 2AB", "Value-guided horizon",
"P(switch) restless", "P(switch) 2AB","P(switch) horizon",
"P(optimal) restless", "P(optimal) 2AB", "P(optimal) horizon"))
cors$y  <-  factor(cors$y, levels = c("Exploration", "Openness",
"Cognitive anxiety", "Somatic anxiety", "Depression",
"Negative mood", "Positive mood",
"Operation span", "Symmetry span", "Updating"))
ggplot(cors, aes(y, x, fill = cor)) + geom_raster() + scale_fill_gradient2(high = "#66C2A5", low = "#FC8D62", mid = "white", limits = c(-1,1))+
geom_label(aes(label = round(cor, digits = 2)), fill = "white") + labs(title = "Correlation of task measures and questionnaire scores",
x = element_blank(), y = element_blank())+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
rm(list = ls())
library(tidyverse)
library(ggplot2)
#library(jsonlite)
library(brms)
library(here)
theme_set(theme_classic(base_size = 14))
here()
session <- 1
source("analysis/recovery_utils.R")
se<-function(x){sd(x, na.rm = T)/sqrt(length(na.omit(x)))}
meann <- function(x){mean(x, na.rm = T)}
############### Horizon task ############
horizon <- load_and_prep_bandit_data(session)$horizon
fit <- brm(chosen ~ RU + (RU | ID),
data = horizon[horizon$Horizon == -0.5 & horizon$trial == 5, ],
family = "bernoulli",
chains = 2,
cores = 2,
iter = 6000)
simdat <- subset(horizon, trial == 5 & Horizon == -0.5, -chosen)
simdat$chosen <- predict(fit)[ ,1]
hist(simdat$chosen)
simdat$chosen <- ifelse(runif(nrow(simdat), 0, 1) > simdat$chosen, 0, 1)
refit <- brm(chosen ~ V + RU + (V + RU | ID),
data = simdat,
family = "bernoulli",
chains = 2,
cores = 2,
iter = 6000)
fit
refit
fit <- brm(chosen ~ V + (V | ID),
data = horizon[horizon$Horizon == -0.5 & horizon$trial == 5, ],
family = "bernoulli",
chains = 2,
cores = 2,
iter = 6000)
simdat <- subset(horizon, trial == 5 & Horizon == -0.5, -chosen)
simdat$chosen <- predict(fit)[ ,1]
hist(simdat$chosen)
simdat$chosen <- ifelse(runif(nrow(simdat), 0, 1) > simdat$chosen, 0, 1)
refit <- brm(chosen ~ V + RU + (V + RU | ID),
data = simdat,
family = "bernoulli",
chains = 2,
cores = 2,
iter = 6000)
fit
refit
